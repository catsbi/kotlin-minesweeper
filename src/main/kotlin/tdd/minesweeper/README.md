# 4단계 - 지뢰 찾기(리팩토링)

## 기능 요구사항

**지뢰 찾기를 변형한 프로그램을 구현한다.**

- 높이와 너비, 지뢰 개수를 입력받을 수 있다.
- 지뢰는 눈에 잘 띄는 것으로 표기한다.
- 지뢰는 가급적 랜덤에 가깝게 배치한다.
- 각 사각형에 표시될 숫자는 자신을 제외한 주변 8개 사각형에 포함된 지뢰의 개수다.
- 지뢰가 없는 인접한 칸이 모두 열리게 된다.

## 기능 요구사항 (detail)

> 고수준의 동시성 및 트랜잭션 기능까지는 고려하지 않는다.

- [x] 게임 입력 인터페이스를 가진다.
    - [x] 게임 입력 구현체를 가진다.
        - [x] 높이 정보를 입력 받는다.
        - [x] 너비 정보를 입력 받는다.
        - [x] 지뢰 갯수를 입력 받는다.
        - [x] 좌표 정보를 입력 받는다.
    - [x] 게임 입력 구현체 프록시를 가진다.
        - [x] 높이 정보가 양수가 아닐 경우 다시 입력 받는다.
        - [x] 너비 정보가 양수가 아닐 경우 다시 입력 받는다.
        - [x] 지뢰 갯수가 양수가 아닐 경우 다시 입력 받는다.
        - [x] 좌표 정보가 유효하지 않을 경우 다시 입력 받는다.
- [x] 게임 출력 인터페이스를 가진다.
    - [x] 게임 출력 구현체를 가진다.
    - [x] 지뢰판 현황 정보를 출력한다.
    - [x] 게임 시작 메세지를 출력한다.
    - [x] 게임 종료 메세지를 출력한다.
- [x] 게임 CLI를 가진다.
    - [x] 사용자에게 지뢰판 생성에 필요한 정보를 입력받는다.
    - [x] 입력받은 요청 정보로 컨트롤러에게 생성을 요청한다.
        - [ ] 생성 결과로 식별자, 응답객체를 받아 출력한다.
    - [x] 사용자에게 마킹할 좌표 정보를 입력받는다.
    - [x] 컨트롤러에게 마킹을 요청한다.
        - [x] 응답 결과를 받아 출력한다.
        - [x] 응답 결과에 게임 진행 상태가 진행 가능일 경우 마킹 정보 요청부터 반복한다.
- [x] 게임 컨트롤러를 가진다.
    - [x] 지뢰판 생성 API를 제공한다.
    - [x] 지뢰판 마킹 API를 제공한다.
- [x] 게임 서비스를 가진다.
    - [x] 지뢰판 생성 기능을 제공한다.
        - [x] 지뢰판을 생성하고 리포지토리에 저장한다.
    - [x] 지뢰판 마킹 기능을 제공한다.
- [x] 게임 리포지토리를 가진다.
    - [x] 인메모리 게임 리포지토리 구현체를 가진다.
        - [x] 지뢰판 정보를 저장한다.
          - [x] 식별자 정보가 존재하고 리포지토리에 없는 경우 새로 저장하고 식별자를 반환한다. 
          - [x] 식별자 정보가 존재하고 리포지토리에 있는 경우 덮어쓰고 식별자를 반환한다. 
          - [x] 식별자 정보가 존재하지 않는 경우 아이디를 할당해서 저장하고 식별자를 반환한다.
        - [x] 지뢰판 정보를 조회한다.
          - [x] 유효한 식별자를 전달하면 적절한 지뢰판을 반환한다.
          - [x] 유효하지 않은 식별자를 전달하면 예외를 던진다.
- [x] 게임 진행 상황 열거 타입을 가진다.
    - [x] 승리, 패배, 진행 타입을 가진다.
    - [x] 진행 가능 여부 프로퍼티를 가진다.
- [x] 인접 좌표 열거 타입을 가진다.
    - [x] 북,북동,동,남동,남,남서,서,북서 타입을 가진다.
    - [x] 이동할 좌표 계산식을 프로퍼티로 가진다.
- [x] 영역 객체를 가진다.
    - [x] 높이 프로퍼티를 가진다.
    - [x] 너비 프로퍼티를 가진다.
    - [x] 넓이 정보를 반환하는 기능을 제공한다.
    - [x] 높이나 너비가 0이하라면 예외를 던진다.
- [x] 좌표 정보 객체를 가진다.
    - [x] x, y 프로퍼티를 가진다.
- [x] 심볼 좌표 정보 객체를 가진다.
    - [x] 좌표 프로퍼티를 가진다.
    - [x] 심볼 프로퍼티를 가진다.
    - [x] 마킹 여부 프로퍼티를 가진다.
    - [x] 심볼 프로퍼티를 수정할 수 있다.
        - [x] MINE 심볼인 경우 수정할 수 없다.
    - [x] 마킹 여부를 조회할 수 있다.
    - [x] 마킹 가능한지 조회할 수 있다.
    - [x] 마킹 기능을 제공한다.
        - [x] 이미 마킹된 상태면 false를 반환한다.
- [x] 심볼 좌표 정보를 행으로 가지는 열 일급 컬렉션 객체를 가진다.
- [x] 여러 열을 다루는 일급 컬렉션 객체를 가진다.
    - [x] 전체 좌표 정보를 캐시해서 Map<좌표정보, 심볼좌표정보> 프로퍼티로 가지고 있는다.
    - [x] 유효한 좌표 정보로 심볼 좌표 정보를 조회할 수 있다.
    - [x] 유효하지 않은 좌표정보는 예외를 던진다.
    - [x] 심볼 좌표 목록 검색 기능을 제공한다.
- [x] 심볼 좌표 정보 2차원 리스트 생성기를 가진다.
    - [x] 영역 정보와, 지뢰 갯수를 매개변수로 받아 심볼 좌표 정보 2차원 List 정보를 생성해 반환한다.
        - [x] 지뢰 갯수를 임의로 배정한다.
        - [x] 각 좌표 정보는 인접 지뢰 갯수만큼 카운팅해 심볼을 업데이트한다.
    - [x] 지뢰 갯수가 영역 정보의 넓이보다 많을 경우 예외를 던진다.
- [x] 지뢰게임판 객체를 가진다.
    - [x] 영역 프로퍼티를 가진다.
    - [x] 심볼 좌표 객체 2차원 배열 정보 일급 컬렉션 프로퍼티를 가진다.
    - [x] 마킹 가능 횟수 프로퍼티를 가진다.
    - [x] 마킹 기능을 제공한다.
        - [x] 유효한 좌표이고 마킹 가능할 경우 마킹한다.
            - [x] 잔여 횟수가 차감된다.
                - [x] 잔여 횟수가 0이면 WIN을 반환한다.
            - [x] 인접 좌표들을 규칙에따라 밝힌다.
                - [x] 마킹한 좌표가 1이상인 경우 인접 좌표를 밝히지 않는다.
                - [x] 인접 좌표가 0인경우 인접 8개 좌표중 MINE이 아닌 좌표를 밝힌다.
                - [x] 인접 좌표의 값이 0인경우 다시 입접한 좌표를 밝힌다.

        - [x] 유효한 좌표이고 마킹 불가능할 경우, 변경없이 CONTINUE 상태를 반환한다.
        - [x] 유효하지 않은 좌표일 경우 예외를 던진다.
- [x] 카운트 객체를 가진다.
    - [x] 잔여 횟수를 감소시킬 수 있으면 감소시키고 결과를 반환한다.
    - [x] 잔여 횟수를 감소시킬 수 없으면 예외를 던진다.
    - [x] 잔여 횟수를 확인할 수 있다.

## 실행 결과

```text
높이를 입력하세요.
10

너비를 입력하세요.
10

지뢰는 몇 개인가요?
10

지뢰찾기 게임 시작
open: 1, 1
0 1 C C C C C C C C
0 1 C C C C C C C C
0 1 C C C C C C C C
1 1 C C C C C C C C
C C C C C C C C C C
C C C C C C C C C C
C C C C C C C C C C
C C C C C C C C C C
C C C C C C C C C C
C C C C C C C C C C

open: 4, 1
Lose Game.

```

# 프로그래밍 요구 사항

> **객체지향 생활 체조 원칙을 지키면서 프로그래밍한다.**

**객체지향 생활 체조 원칙**

- 한 메서드에 오직 한 단계의 들여쓰기만 한다.
- else 예약어를 쓰지 않는다.
- 모든 원시 값과 문자열을 포장한다.
- 한 줄에 점을 하나만 찍는다.
- 줄여 쓰지 않는다(축약 금지).
- 모든 엔티티를 작게 유지한다.
- 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.
- 일급 컬렉션을 쓴다.
- getter/setter/프로퍼티를 쓰지 않는다.
- 객체 지향 5원칙을 지키면서 프로그래밍한다.

### 객체지향 5원칙(SOLID)

- SRP (단일책임의 원칙: Single Responsibility Principle): 작성된 클래스는 하나의 기능만 가지며 클래스가 제공하는 모든 서비스는 그 하나의 책임(변화의 축: axis of
  change)을 수행하는 데 집중되어 있어야 한다
- OCP (개방폐쇄의 원칙: Open Close Principle): 소프트웨어의 구성요소(컴포넌트, 클래스, 모듈, 함수)는 확장에는 열려있고, 변경에는 닫혀있어야 한다.
- LSP (리스코브 치환의 원칙: The Liskov Substitution Principle): 서브 타입은 언제나 기반 타입으로 교체할 수 있어야 한다. 즉, 서브 타입은 언제나 기반 타입과 호환될 수 있어야
  한다.
- ISP (인터페이스 분리의 원칙: Interface Segregation Principle): 한 클래스는 자신이 사용하지 않는 인터페이스는 구현하지 말아야 한다.
- DIP (의존성역전의 원칙: Dependency Inversion Principle): 구조적 디자인에서 발생하던 하위 레벨 모듈의 변경이 상위 레벨 모듈의 변경을 요구하는 위계관계를 끊는 의미의 역전 원칙이다.

